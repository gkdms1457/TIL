---
title : board vulnerability analysis
category :
    - vulnerability
    - webhacking
tag :
    - webhacking
published : false
---

내가 만든 게시판 사이트의 취약점 분석   
[gkdms1457/webtutorial(소스코드)](https://github.com/gkdms1457/webtutorial)  
[heom.cafe24.com](https://heom.cafe24.com/)  
[whdbsgh00.cafe24.com](https://whdbsgh00.cafe24.com/web/main.php)

---

## SQL injection
 [whdbsgh00.cafe24.com](https://whdbsgh00.cafe24.com/web/main.php)
 로그인 폼에 아이디와 비밀번호를 입력하면 입력값이 서버로  전달되고, 해당 값을 데이터 베이스에서 찾아 일치한다면 로그인에  성공한다. 그때 사용하는 sql query문은  
 `SELECT * FROM (user 테이블명) WHERE id = ‘admin’ and pwd=’admin’ `이다.   
 만약 아이디에 ‘or 1=1#를 입력하고 비밀번호로 아무거나 보낸다면 sql query구문은  
  `SELECT * FROM (TABLE) WHERE id = ‘admin‘or 1=1# and pwd=’pwd’`가 된다.   
  이렇게 되면 or 1=1이 무조건 맞기 때문에 데이터베이스의 값들을 가져와 admin계정으로 로그인이 가능하게 된다.

 ![sql injection](/TIL/assets/images/sqlinjection.PNG)


## 파일 업로드 공격
 [heom.cafe24.com](https://heom.cafe24.com/)  
 [whdbsgh00.cafe24.com](https://whdbsgh00.cafe24.com/web/main.php)

 파일 업로드 기능을 악용하여 악의적인 파일 업로드를 통해 원하는 정보를 얻는 방법이다.

 ```
 <webshelltest.php>파일 내용
   <? php echo system('ls'); ?>
 ```

 악의적인 내용을 가진 파일을 웹페이지에 업로드한다. 업로드한 후 개발자 도구를 이용하여 어디에 해당파일이 저장되어 있는지를 확인한다.  

 ![file upload1](/TIL/assets/images/fileupload1.PNG) 

 해당 내용을 보면 현재 디렉토리에 있는 fileupload라는 파일아래에 저장되는 것을 알 수 있다. 이를 이용해 heom.cafe24.com/fileupload/webshelltest.php에 접속하면  
 
 ![file upload2](/TIL/assets/images/fileupload2.PNG)  

 해당 파일 아래에 존재하는 파일을 확인할 수 있다.


## XSS(Cross Site Scripting)
 [heom.cafe24.com](https://heom.cafe24.com/)  
 [whdbsgh00.cafe24.com](https://whdbsgh00.cafe24.com/web/main.php)
 
 게시판이나 웹 메일등에 스크립트 코드를 삽입하여 사용자가 의도하지 않은 일을 수행하도록 하는 공격기법으로 stored XSS와 Reflected XSS가 존재한다
 
 ### Stored XSS
 악의적인 코드가 웹에 입력되면서 데이터 베이스에 저장되어 발생하는 공격이다. 불특정 다수의 사용자가 공격자의 게시물에 접근하면 지속적으로 악의적인 스크립트가 실행된다.

 ![XSS](/TIL/assets/images/XSS1.PNG) 

 게시판에 스크립트 코드가 포함된 게시물을 만든다.
 
 ![XSS](/TIL/assets/images/XSS2.PNG) 
 
 이후 해당 게시글을 확인하면 알림창이 뜨는 것을 확인할 수 있다.  

 ![XSS](/TIL/assets/images/XSS3.PNG) 


 ### Reflected XSS
 ![XSS](/TIL/assets/images/XSS4.PNG) 


## CSRF(Cross Site Request Forgery)
 [heom.cafe24.com](https://heom.cafe24.com/)  
 [whdbsgh00.cafe24.com](https://whdbsgh00.cafe24.com/web/main.php)  
 공격자에 의해 사용자가 의도하지 않은 악의적인 행위를 서버에 요청하는 공격기법이다. 
 1. 악의적 스크립트 코드에 접근하면 
 2. 웹브라우저는 스크립트 코드를 웹서버에 요청한다. 
 3. 웹서버는 변조된 요청을 정상적인 요청으로 판단하고 응답을 보낸다.

 ![CSRF](/TIL/assets/images/CSRF1.PNG) 

 XSS와 비슷해보이지만 다른 공격기법이다. CSRF는 웹브라우저를 신뢰해서 발생하는 취약점으로, 사용자가 보낸 정상적인 요청과 변조된 요청을 구별하지 못한다. 또한, XSS는 공격대상이 사용자이지만, CSRF는 사용자를 공격 매개로하여 악의적인 요청을 웹사이트에게 보낸다는 것이다.